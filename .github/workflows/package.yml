name: package build workflow
on:
  push:
    branches: [ master, github-build-action ]
  pull_request:
    branches: [ master ]

jobs:
  package_job:
    runs-on: ubuntu-latest
    name: A job to build the packages
    steps:
    - name: build it step
      id: build-it-now
    - uses: actions/checkout@v2
      uses: richardmarston/arabica@ac4ec791b3d0f0186c8cbcf8939018bb99550bed
      with:
        commit: ${GITHUB_SHA}
        version: "0.1"
    - name: check commit
    - run:  echo "the commit id is ${{ inputs.commit }}"
    - name: get artifacts
    - run:  mkdir artifacts; rpmfile=$(find . -iname "*.rpm"); debfile=$(find . -iname "*.deb"); cp $rpmfile $debfile artifacts
    - name: upload artifacts
    - uses: actions/upload-artifact@v2
      with:
        name: arabica-pkgs
        path: artifacts
